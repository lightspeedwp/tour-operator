/**
 * Slider Block Styles
 * Shared between editor and frontend
 */

.wp-block-lsx-tour-operator-slider {
	position: relative;
	//overflow: hidden;

	// Target WordPress layout container classes for gap support
	[class*="wp-container-lsx-tour-operator-slider-group-is-layout-"] {
		&.slider-slides-wrapper {
			// WordPress will apply gap via these layout classes
			// Don't override the gap - let WordPress handle it
		}
	}

	// Fallback for manual gap support
	&[style*="gap"] .slider-wrapper,
	&[class*="has-"] .slider-wrapper {
		> * {
			gap: var(--wp--style--block-gap, 1rem);
		}
	}

	&.slider-group-active {
		.slider-group-container {
			position: relative;
			width: 100%;
		}

		.slider-info {
			position: absolute;
			top: 10px;
			right: 10px;
			background: rgba(0, 0, 0, 0.7);
			color: white;
			padding: 4px 8px;
			border-radius: 4px;
			font-size: 12px;
			z-index: 10;
			pointer-events: none;
			display: flex;
			align-items: center;
			gap: 4px;

			.slider-info-text {
				pointer-events: none;
				white-space: nowrap;
			}

			.slider-info-arrow {
				background: transparent;
				border: none;
				color: white;
				cursor: pointer;
				pointer-events: auto;
				padding: 2px;
				border-radius: 2px;
				display: flex;
				align-items: center;
				justify-content: center;
				transition: all 0.2s ease;
				width: 16px;
				height: 16px;

				&:hover {
					background: rgba(255, 255, 255, 0.2);
				}

				&:disabled {
					opacity: 0.3;
					cursor: not-allowed;

					&:hover {
						background: transparent;
					}
				}

				svg {
					width: 12px;
					height: 12px;
				}
			}
		}

		.slider-wrapper {
			position: relative;
			width: 100%;
		}

		.slider-container {
			position: relative;
			width: 100%;
			overflow: hidden; // Backup overflow control
		}

		.slider-slides-wrapper {
			display: flex !important;
			position: relative;
			width: 100%;
			transition: transform 0.3s ease-in-out;
			flex-direction: row!important;
			// This is the single wrapper that moves to show different slides
			// Let WordPress handle the gap via CSS variables
		}

		.slider-slide {
			position: relative;
			flex: 0 0 auto;
			transition: transform 0.3s ease-in-out;
			box-sizing: border-box;
			// Remove hardcoded padding - let WordPress handle spacing via gap
			padding: 0;
			display: flex;
			flex-direction: column;
			opacity: 0;

			&.active-slide {
				z-index: 2;
			}

			// Ensure equal heights
			> .wp-block-group__inner-container {
				flex: 1;
				display: flex;
				flex-direction: column;
			}
		}

		// Navigation arrows
		.slider-nav {
			position: absolute;
			top: 50%;
			transform: translateY(-50%);
			left: 0;
			right: 0;
			display: flex;
			justify-content: space-between;
			pointer-events: none;
			z-index: 15;
			padding: 0 10px;
			&.slider-nav-outer {
				transform: translateY(-50%);
				left: -75px;
				right: -75px;
				align-items: center;
				justify-content: space-between;
			}

		}

		.slider-arrow {
			background: transparent;
			border: none;
			width: 54px;
			height: 54px;
			display: flex;
			align-items: center;
			justify-content: center;
			cursor: pointer;
			pointer-events: auto;
			transition: all 0.2s ease;
			z-index: 16;

			&:hover {
				// get primary theme color from WordPress
				color: var(--wp--preset--color--primary, #007cba);
			}

			&:disabled {
				opacity: 0.3;
				cursor: not-allowed;
				transform: none;

				&:hover {
					transform: none;
				}
			}

			&:focus {
				outline: 2px solid #007cba;
				outline-offset: 2px;
			}

			svg {
				width: 54px;
				height: 54px;
			}
		}

		// Navigation dots (only show on frontend)
		.slider-dots {
			display: flex;
			justify-content: center;
			gap: 8px;
			margin-top: 16px;
			padding: 10px 0;
		}

		.slider-dot {
			width: 46px;
			height: 46px;
			border: none;
			background: transparent;
			cursor: pointer;
			transition: all 0.2s ease;
			padding: 0;

			&:focus {
				outline: 2px solid #007cba;
				outline-offset: 2px;
			}

			&:hover {
				color: var(--wp--preset--color--primary, #007cba);
			}
		}

		// Responsive behavior
		@media (max-width: 768px) {
			&.wp-block-lsx-tour-operator-slider .slider-nav-outer {
				display: none;
			}
		}
	}

	// Editor specific styles
	&.is-selected {
		.slider-info {
			background: rgba(0, 123, 186, 0.8);
		}
	}

	// Dragging state
	&.is-dragging {
		.slider-container,
		.slider-slides-wrapper {
			transition: none;
		}

		.slider-slide {
			transition: none;
		}
	}
}

// Editor specific enhancements
.block-editor-block-list__layout {
	.wp-block-lsx-tour-operator-slider {
		// Ensure proper spacing in editor
		margin: 16px 0;

		&.slider-group-active {
			// Hide dots in editor by default
			.slider-dots {
				display: none !important;
			}

			// Make sure arrows are always visible in editor
			.slider-nav {
				opacity: 1;
				visibility: visible;
			}

			.slider-arrow {
				background: rgba(0, 123, 186, 0.8);

				&:hover {
					background: rgba(0, 123, 186, 1);
				}
			}
		}

		.slider-slide-appender {
			display: flex;
			align-items: center;
			justify-content: center;
			min-height: 100px;
			border: 2px dashed #ccc;
			border-radius: 4px;
			margin: 0 8px;
			flex: 0 0 auto;
			width: calc(33.333% - 16px);

			.block-list-appender {
				margin: 0;
			}
		}

		// Make slides clickable in editor
		.slider-slide {
			cursor: pointer;

			&:hover {
				outline: 2px solid #007cba;
				outline-offset: 2px;
			}

			&.is-selected {
				outline: 2px solid #007cba;
				outline-offset: 2px;
			}
		}
	}
}

// Animation utilities
.slider-fade-enter {
	opacity: 0;
}

.slider-fade-enter-active {
	opacity: 1;
	transition: opacity 0.3s ease;
}

.slider-fade-exit {
	opacity: 1;
}

.slider-fade-exit-active {
	opacity: 0;
	transition: opacity 0.3s ease;
}

// Accessibility improvements
@media (prefers-reduced-motion: reduce) {
	.wp-block-lsx-tour-operator-slider {
		&.slider-group-active {
			.slider-container,
			.slider-slides-wrapper,
			.slider-slide,
			.slider-arrow {
				transition: none !important;
			}
		}
	}
}

// High contrast mode support
@media (prefers-contrast: high) {
	.wp-block-lsx-tour-operator-slider {
		&.slider-group-active {
			.slider-arrow {
				background: black;
				border: 2px solid white;
			}

			.slider_dot {
				border-color: black;

				&.active {
					background: black;
				}
			}
		}
	}
}

.slider-group-container {
	position: relative;
	z-index: 1;
	margin: auto;
	max-width: 100vw;
	@media (max-width: 767px) {
		overflow: hidden;
	}
}

@media (max-width: 768px) {
  .wp-block-lsx-tour-operator-slider[data-max-slides-mobile="1"] .slider-slides-wrapper {
    width: 100% !important;
    display: flex !important;
    justify-content: center;
    align-items: center;
    transition: none;
    transform: none !important;
  }
  .wp-block-lsx-tour-operator-slider[data-max-slides-mobile="1"] .slider-slide {
    max-width: 320px;
    width: 100%;
    margin-left: auto;
    margin-right: auto;
    flex: 0 1 auto !important;
    opacity: 1 !important;
    display: none !important;
  }
  .wp-block-lsx-tour-operator-slider[data-max-slides-mobile="1"] .slider-slide.active-slide {
    display: flex !important;
  }
}
