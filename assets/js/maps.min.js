"use strict";var infowindow,$gmap="",gmap_markers=[],icons=[],LSX_TO_Maps={initThis:function(){var t=jQuery(".lsx-map:eq(0)"),e=Number(t.attr("data-lat")),a=Number(t.attr("data-long")),s=Number(t.attr("data-zoom")),r=t.attr("data-type"),o=(this.type=r,Number(t.attr("data-height"))),n=t.attr("data-class"),i=t.attr("data-icon"),l=t.attr("data-url"),u=t.attr("data-cluster-small"),p=t.attr("data-cluster-medium"),m=t.attr("data-cluster-large"),u=("undefined"==u&&"undefined"==p&&"undefined"==m?this.cluster_disable=!0:(this.cluster_small=u,this.cluster_medium=p,this.cluster_large=m,this.cluster_disable=!1),this.fusion_tables_countries={},this.fusion_tables_colour_border=t.attr("data-fusion-tables-colour-border"),this.fusion_tables_width_border=t.attr("data-fusion-tables-width-border"),this.fusion_tables_colour_background=t.attr("data-fusion-tables-colour-background"),!1),p=(this.framework_url=l,this.latlng=new google.maps.LatLng(e,a),this.icon_url=new google.maps.MarkerImage(i,null,null,null,new google.maps.Size(32,32)),this.bounds=[],jQuery(n+":eq(0)")),m=(".lsx-map-preview"!=n?(o=p.css("height"),p.find(".container").hide()):"route"===r&&"undefined"!==t.attr("data-kml")?u=t.attr("data-kml"):p.css("height",o),null),l=null,e=(".lsx-map-preview"!=n&&(jQuery(n).addClass("gmap-banner"),t.closest("section").hide(),t.closest("section").appendTo("footer.content-info"),1==jQuery(n).children(".container").length&&(m=jQuery(n).children(".container").clone(!0,!0)),1==jQuery(n).children(".breadcrumbs-container").length&&(l=jQuery(n).children(".breadcrumbs-container").clone(!0,!0))),null),a=null;"undefined"!=typeof SnazzyDataForSnazzyMaps&&void 0!==SnazzyDataForSnazzyMaps.json&&(e=jQuery.parseJSON(SnazzyDataForSnazzyMaps.json),a=new google.maps.StyledMapType(e,{name:"Styled Map"})),this.mapObj=new google.maps.Map(p[0],{zoom:s,maxZoom:21,minZoom:1,center:this.latlng,scrollwheel:!1,draggable:!0,mapTypeControl:!1,overviewMapControl:!1,panControl:!1,rotateControl:!1,mapTypeId:google.maps.MapTypeId.TERRAIN,mapTypeControlOptions:{mapTypeIds:[google.maps.MapTypeId.TERRAIN,"map_style"]}}),null!==e&&null!==a&&(this.mapObj.mapTypes.set("map_style",a),this.mapObj.setMapTypeId("map_style")),0!=u&&null!=u?this.addRoute():(this.refreshMarkers(),"route"!=r||0!=u&&null!=u||this.drawRoute()),t.hasClass("disable-auto-zoom")||"cluster"!=r&&("route"!=r||0!=u&&null!=u)?this.setCenter():(1<this.bounds.length?this.setBounds():(this.latlng=this.bounds[0],console.log(this.latlng),this.setCenter()),p.css("height",o)),this.resizeThis(),null!==m&&jQuery(n).append(m),null!==l&&(l.find(".container").show(),jQuery(n).after(l)),$gmap=this.mapObj},resizeThis:function(){google&&google.maps&&google.maps.event.trigger(this.mapObj,"resize")},drawRoute:function(){var t=[];0<jQuery(".lsx-map-markers").length&&jQuery(".lsx-map-markers .map-data").each(function(){t.push({lat:Number(jQuery(this).attr("data-lat")),lng:Number(jQuery(this).attr("data-long"))})}),new google.maps.Polyline({path:t,geodesic:!0,strokeColor:"#000000",strokeOpacity:1,strokeWeight:1.5}).setMap(this.mapObj)},generateRoute:function(){0<jQuery(".lsx-map-markers").length&&jQuery(".lsx-map-markers .map-data").each(function(){coordinates.push(jQuery(this).attr("data-lat")+" "+Number(jQuery(this).attr("data-long")))}),jQuery.get("https://roads.googleapis.com/v1/snapToRoads",{interpolate:!0,key:lsx_to_maps_params.apiKey,path:coordinates.join("|")},function(t){})},addFusionLayer:function(){0<jQuery("#script-fusion-tables").length&&jQuery("#script-fusion-tables").remove();var t,e=[];for(t in this.fusion_tables_countries)e.push("'"+t+"'");var a=document.createElement("script"),s=["https://www.googleapis.com/fusiontables/v1/query?"],r="SELECT Name, geometry FROM 1N2LBk4JHwWpOY4d9fobIn27lfnZ5MDy-NoqqRpk WHERE Name IN ("+e.join()+")",r=encodeURIComponent(r),o=document.getElementsByTagName("body")[0];s.push("sql="),s.push(r),s.push("&callback=LSX_TO_Maps.drawFusionLayer"),s.push("&key="+lsx_to_maps_params.apiKey),a.id="script-fusion-tables",a.src=s.join(""),o.appendChild(a)},drawFusionLayer:function(t){var e,a=t.rows;for(e in a){var s=[],r=a[e][1].geometries;if(r)for(var o in r)s.push(this.constructNewCoordinates(r[o]));else s=this.constructNewCoordinates(a[e][1].geometry);var n=new google.maps.Polygon({paths:s,strokeColor:this.fusion_tables_colour_border,strokeOpacity:.6,strokeWeight:this.fusion_tables_width_border,fillColor:this.fusion_tables_colour_background,fillOpacity:.3,countryName:a[e][0]});google.maps.event.addListener(n,"mouseover",function(){this.setOptions({fillOpacity:.6})}),google.maps.event.addListener(n,"mouseout",function(){this.setOptions({fillOpacity:.3})}),google.maps.event.addListener(n,"click",function(t){infowindow&&infowindow.close();var e=LSX_TO_Maps.fusion_tables_countries[this.countryName];(infowindow=new google.maps.InfoWindow({content:'<div class="lsx-to-map-marker"><img class="lsx-to-map-marker-img" src="'+e.thumbnail+'"><div class="lsx-to-map-marker-content content-area"><h4 class="lsx-to-map-marker-title">'+e.title+"</h4>"+e.content+'</div><br clear="all"/>'})).setPosition(t.latLng),infowindow.open($gmap)}),n.setMap(this.mapObj)}},constructNewCoordinates:function(t){var e,a=[],s=t.coordinates[0];for(e in s)a.push(new google.maps.LatLng(s[e][1],s[e][0]));return a},setCenter:function(){this.mapObj.setCenter(this.latlng)},refreshMarkers:function(){gmap_markers=[],icons=[],this.fusion_tables_countries={};var e=[],a=this;if(jQuery(".lsx-map-markers").length){var s=0,r=jQuery(".lsx-map-markers .map-data").length-1;jQuery(".lsx-map-markers .map-data").each(function(){var t=new google.maps.LatLng(Number(jQuery(this).attr("data-lat")),Number(jQuery(this).attr("data-long")));e.push(t),"1"===jQuery(this).attr("data-fusion-tables")?LSX_TO_Maps.fusion_tables_countries[jQuery(this).attr("data-title")]={title:'<a href="'+jQuery(this).attr("data-link")+'">'+jQuery(this).attr("data-title")+"</a>",thumbnail:jQuery(this).attr("data-thumbnail"),content:jQuery(this).html()}:(gmap_markers.push({marker:t,title:'<a target="_blank" rel="noopener noreferrer" href="'+jQuery(this).attr("data-link")+'">'+jQuery(this).attr("data-title")+"</a>",thumbnail:jQuery(this).attr("data-thumbnail"),content:jQuery(this).html()}),t=jQuery(this).attr("data-icon"),"route"!=a.type||0!=s&&r!=s||(t=0==s?lsx_to_maps_params.start_marker:lsx_to_maps_params.end_marker),icons.push(t),s++)});for(var t,o=0;o<gmap_markers.length;o++)gmap_markers[o]=this.createMarker(gmap_markers[o],icons[o]);this.bounds=e,1==this.cluster_disable&&"cluster"==this.type&&(t=[{url:this.cluster_small,height:52,width:53,anchor:[0,0],textColor:"#ffffff"},{url:this.cluster_medium,height:52,width:53,anchor:[0,0],textColor:"#ffffff"},{url:this.cluster_large,height:52,width:53,anchor:[0,0],textColor:"#ffffff"}],new MarkerClusterer(this.mapObj,gmap_markers,{styles:t})),0<Object.keys(LSX_TO_Maps.fusion_tables_countries).length&&this.addFusionLayer()}},createMarker:function(t,e){var a=new google.maps.Marker({position:t.marker,map:this.mapObj,title:jQuery(t.title).text(),icon:e});return a.addListener("click",function(){infowindow&&infowindow.close(),infowindow=new google.maps.InfoWindow({content:'<div class="lsx-to-map-marker"><img class="lsx-to-map-marker-img" src="'+t.thumbnail+'"><div class="lsx-to-map-marker-content content-area"><h4 class="lsx-to-map-marker-title">'+t.title+"</h4>"+t.content+'</div><br clear="all"/>'}),google.maps.event.addListener(infowindow,"domready",function(){window.setTimeout(function(){$gmap.panBy(0,-30)},700)}),infowindow.open($gmap,a)}),a},addRoute:function(t){new google.maps.KmlLayer({url:t,map:this.mapObj});this.resizeThis()},setBounds:function(){if(google&&google.maps){for(var t=new google.maps.LatLngBounds,e=0;e<this.bounds.length;e++)t.extend(this.bounds[e]);this.mapObj.fitBounds(t)}},watchMapTriggers:function(){jQuery(document).on("click",".lsx-map-placeholder, .placeholder-text",function(t){jQuery.getScript(lsx_to_maps_params.google_url,function(){jQuery.getScript(lsx_to_maps_params.google_cluster_url),LSX_TO_Maps.initThis()})})}};jQuery(document).ready(function(t){0<jQuery(".lsx-map").length&&(""===lsx_to_maps_params.placeholder_enabled?LSX_TO_Maps.initThis():LSX_TO_Maps.watchMapTriggers())});